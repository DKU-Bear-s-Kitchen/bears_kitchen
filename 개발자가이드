# Bear’s Kitchen 개발자 가이드 (Developer Guide)

본 문서는 ‘Bear’s Kitchen’ 프로젝트에 신규 참여한 개발자가
본 문서만을 참고하여 개발 환경 구성부터 기능 구현까지
바로 착수할 수 있도록 작성된 실무 중심 개발 가이드이다.

====================================================
1. 프로젝트 개요
====================================================

프로젝트명: Bear’s Kitchen  
프로젝트 기간: 2025.09 ~ 2025.12  
서비스 대상: 단국대학교 학생  
서비스 형태: Firebase 기반 서버리스 모바일 앱 (Flutter)

Bear’s Kitchen은 교내 학식 메뉴 정보를 통합 제공하고,
사용자 리뷰 데이터와 LLM 기반 AI 기능(리뷰 요약, 메뉴 추천)을
결합한 학식 정보 플랫폼이다.

====================================================
2. 시스템 아키텍처 개요
====================================================

[클라이언트]
- Flutter App (Android / iOS)

[백엔드 & 인프라]
- Firebase Authentication
- Cloud Firestore
- Firebase AI Logic (Vertex AI, Gemini)
- Firebase Console 기반 운영

[동작 흐름]
사용자 → Flutter App →
Firebase Auth / Firestore →
필요 시 Firebase AI Logic 호출 →
결과를 앱 UI에 반영

====================================================
3. 개발 환경 설정
====================================================

3.1 필수 개발 환경

- OS
  - Windows 11 또는 macOS Sonoma 이상

- Flutter
  - Flutter 3.19 이상
  - Dart 3.3 이상

- IDE
  - VS Code 또는 Android Studio

- Firebase
  - Firebase Console 접근 권한
  - Firestore, Authentication, Vertex AI 사용 가능 프로젝트

3.2 Flutter 프로젝트 초기 세팅

1) Flutter SDK 설치
2) flutter doctor로 환경 점검
3) 신규 프로젝트 생성
   flutter create bears_kitchen

4) 주요 패키지 설치 (pubspec.yaml)
- cloud_firestore
- firebase_auth
- firebase_core
- provider
- http

5) Firebase 연동
- iOS / Android 앱 Firebase 등록
- google-services.json / GoogleService-Info.plist 추가
- flutterfire configure 실행

====================================================
4. 프로젝트 디렉토리 구조
====================================================

lib/
 ├── main.dart
 ├── core/
 │    ├── theme/
 │    ├── constants/
 │    └── utils/
 │
 ├── models/
 │    ├── menu.dart
 │    ├── review.dart
 │    ├── store.dart
 │    └── user.dart
 │
 ├── services/
 │    ├── auth_service.dart
 │    ├── firestore_service.dart
 │    └── ai_service.dart
 │
 ├── providers/
 │    ├── menu_provider.dart
 │    ├── review_provider.dart
 │    └── user_provider.dart
 │
 └── screens/
      ├── home/
      ├── detail/
      ├── search_ai/
      └── my_page/

====================================================
5. Firestore 데이터베이스 설계
====================================================

5.1 컬렉션 목록

- menus
- reviews
- users
- stores
- notices

5.2 menus 컬렉션

용도: 메뉴 정보 및 캐싱 데이터 저장

필드:
- name (String)
- price (Number/String)
- isNew (Boolean)
- averageRating (Number)
- reviewCount (Number)
- createdAt (Timestamp)

주의:
- averageRating, reviewCount는 실시간 계산이 아니라 캐싱 값임

5.3 reviews 컬렉션

용도: 사용자 리뷰 데이터 저장

필드:
- content (String)
- rating (Number: 1~5)
- menuName (String)
- storeId (String)
- userId (String)
- createdAt (Timestamp)

5.4 users 컬렉션

용도: 사용자 프로필 관리

필드:
- email (String)
- nickname (String)
- studentId (String)
- department (String)
- createdAt (Timestamp)

5.5 stores 컬렉션

용도: 식당 정보 관리

필드:
- name (String)
- menus (Array)
- averageRating (Number)
- reviewCount (Number)
- createdAt (Timestamp)

5.6 notices 컬렉션

용도: 공지사항 관리

필드:
- title (String)
- content (String)
- date (Timestamp)

====================================================
6. 주요 기능별 구현 가이드
====================================================

6.1 메뉴 조회 기능

- Firestore menus 컬렉션을 Stream으로 연결
- StreamBuilder 사용
- 실시간 데이터 변경 시 자동 UI 갱신

구현 포인트:
- 초기 로딩 상태 표시
- 데이터 없을 경우 Empty State 처리

----------------------------------------------------

6.2 메뉴 필터링 및 정렬

지원 조건:
- 식당 기준 필터
- 가격 범위 필터
- 최소 별점 기준
- 가격순 / 별점순 / 리뷰 많은 순 정렬

구현 방식:
- Firestore Query를 조건에 따라 동적 생성
- 복합 쿼리 사용 시 사전 인덱스 생성 필수

----------------------------------------------------

6.3 리뷰 작성 기능

동작 순서:
1) Firebase Auth 로그인 여부 확인
2) 리뷰 입력값 Validation
3) reviews 컬렉션에 데이터 저장
4) menus 컬렉션의
   - averageRating
   - reviewCount
   트랜잭션 업데이트

주의사항:
- 리뷰 삭제 시에도 통계값 재계산 필요

----------------------------------------------------

6.4 LLM 기반 리뷰 요약 기능

동작 흐름:
1) 특정 메뉴 선택
2) 해당 메뉴 리뷰 목록 조회
3) 리뷰 텍스트 묶음 생성 (길이 제한 적용)
4) Firebase AI Logic 호출
5) 요약 결과 UI 출력

사용 모델:
- Gemini 2.5 Flash
- JSON 모드 활용 (정형 응답)

UX 처리:
- 로딩 인디케이터 표시
- 오류 시 사용자 친화적 메시지 출력

----------------------------------------------------

6.5 AI 메뉴 추천 기능

입력:
- 사용자 자연어 문장
  예) "매콤한 국물 요리 먹고 싶어"

처리 흐름:
1) 입력값을 AI Logic으로 전달
2) Firestore 메뉴 리스트와 매칭
3) 추천 메뉴 3~4개 반환
4) 카드 UI 형태로 결과 출력

----------------------------------------------------

6.6 회원 관리 및 마이페이지

기능:
- 회원가입 / 로그인 (Firebase Auth)
- 내가 쓴 리뷰 조회 및 삭제
- 공지사항 조회
- 로그아웃 / 회원 탈퇴

구현 주의:
- Auth 삭제 시 Firestore 사용자 데이터도 정리 필요

====================================================
7. 트러블슈팅 가이드
====================================================

7.1 Firestore 복합 쿼리 오류

증상:
- FAILED_PRECONDITION 에러 발생

원인:
- 복합 인덱스 미생성

해결:
- Firebase Console → Firestore → Indexes
- 에러 메시지에 제공된 링크 통해 인덱스 생성

----------------------------------------------------

7.2 AI 응답 지연 문제

해결 방법:
- 로딩 인디케이터 필수 적용
- 프롬프트 길이 최소화
- Gemini Flash 모델 사용

====================================================
8. 테스트 가이드
====================================================

필수 테스트 항목:
- 메뉴 조회 정상 여부
- 필터링 및 정렬 정확성
- 리뷰 작성/삭제 반영 여부
- AI 요약 결과 수신 여부
- 네트워크 오류 시 앱 안정성

====================================================
9. 유지보수 및 확장 시 유의사항
====================================================

- 리뷰 데이터 증가 시
  → AI 응답 캐싱 전략 도입 고려
- 사용자 수 증가 시
  → Vertex AI 호출 비용 관리 필요
- Firestore 읽기 쿼리 최적화 필수

====================================================
10. 마무리
====================================================

본 가이드는 Bear’s Kitchen 프로젝트의
개발, 유지보수, 인수인계를 모두 고려하여 작성되었으며,
본 문서만으로도 전체 개발 흐름을 파악하고
즉시 구현이 가능하도록 구성되었다.